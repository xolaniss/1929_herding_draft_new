---
format:
  pdf:
    tbl-cap-location: top
    dpi: 500
    fig-pos: "H"
    number-sections: true
    cite-method: natbib
    include-in-header: preamble.tex
    include-before-body: title.tex
    keep-tex: true
    fig-format: png
    default-image-extension: png
  # docx:
  #   reference-doc: new_template_no_numbering.docx
pdf-engine: lualatex
monofont: "DejaVu Sans Mono"
mainfont: "Times New Roman"
execute: 
  echo: false
  warning: false
  cache: false
editor: source
bibliography: references.bib
biblio-style: apalike
natbiboptions: round
link-citations: true
linkcolor: blue!100!black
urlcolor: blue!100!black
citecolor: blue!100!black
linestretch: 1.5
indent: TRUE
---

```{r}
#| label: setup
#| include: false
options(scipen=999)
knitr::opts_chunk$set(
                      fig.pos = "H", 
                      fig.env= 'figure', 
                      ft.align = "left",
                      ft.tabcolsep= 0, 
                      ft.latex.float = "none",
                      ft.arraystretch = 0.4
                      )
library(tidyverse)
library(readr)
library(readxl)
library(zoo)
library(magick)
library(stringi)
library(patchwork)
library(xtable)
library(scales)
library(rvest)
library(rebus)
library(PNWColors)
library(lubridate)
library(here)
library(flextable)
library(officer)
library(officedown)
library(modelsummary)
library(sandwich)
library(lmtest)
library(stargazer)
library(renv)
```

```{r}
#| label: func
source(here("Functions","flextable_word.R" ))
source(here("Functions","modelsummary_pdf.R" ))
source(here("Functions","borderlines.R" ))

set_flextable_defaults(font.size = 7, 
                       text.align = "left", 
                       font.color = "black", 
                       theme_fun = theme_apa, 
                       padding = 0,
                       line_spacing = 0)
```


# Introduction

One of the most influential concepts in the mainstream finance literature is that of market efficiency that was formulated by @fama1970efficient among others. However, the concept of an informationally efficient market rests on a series of assumptions that assume away the presence of costly and asymmetric information, agency problems, market frictions such as transaction costs or limits to arbitrage in addition to irrational economic behaviour. Although the concept of rationality takes on a central role in how we model the behavior of economic agents, there is growing evidence suggesting that investors often suppress their own beliefs and mimic the trades of others when making investment choices. While such behavior is in line with the the notion of `animal spirits' highlighted in the financial economics literature [@kahneman2003maps; @shiller2005behavioral; @dai2020animal] as well as the presence of psychological biases in economic decision making [@kahneman2003maps], eventually leading to the prestigious Noble Prize in Economics 2002, herd formation is considered to be an inefficient form of information processing by agents, which can lead to excessive volatility and price distortions [among others @bikhchandani1992theory; @nofsinger1999herding; @kyle2001contagion; @acharya2009prologue; @ali2023anti].

Inefficiencies in how investors process information can be due to behavioural biases or other deviations from rationality such as herding or feedback trading [@aggarwal2014animal]. In the literature, while several studies argue that herd formation can be a result of information asymmetries wherein following the market consensus creates a sense of security among less informed traders [e.g. @devenow1996rational], others argue that managers’ tendency to avoid reputation related costs can also drove such behavior [e.g. @maug1996herding]. While some of the factors that drive such inefficient behavior by investors can be mitigated by improving market transparency or informational asymmetries, political conditions emerge as a significant source of uncertainty that can induce such behavior in financial markets. Interestingly, however, although the literature offers ample evidence that links political factors with financial market dynamics, how political factors relate to herd behavior in financial markets is relatively understudied. Against this backdrop, the main goal of this paper is to examine the role of political cycles on investor behavior in the U.S. stock market with a particular focus on herding behavior. To this end, we utilize a century of stock market data spanning from 1926 to 2022 which allows us to examine not only a long history of presidential cycles, but also a wide range of market crisis periods that can also contribute to herding. 

In particular, our study makes the following contributions to the literature. First, we provide new evidence on the presence of herding behaviour across different industry groups in the U.S. stock market using a long history of data that allows us to examine a wide range of market crisis periods. Furthermore, we distinguish between spurious herding that can occur as a result of investors’ common, rational responses to public information and intentional herding that is associated with informational inefficiencies. Although herding in the U.S. stock market has been examined in the literature, our analysis provides a comprehensive perspective of its evolution within a time-varying framework by distinguishing between spurious and intentional herding. Second, we examine the determinants of herding behaviour across different industry groups by focusing on the role of market crises on herding behaviour. Finally and more importantly, motivated by the recent evidence in @gavriilidis2024political that links political uncertainty to herding among institutional investors, we investigate the role of political cycles and approval ratings on herding behaviour in the stock markets. Accordingly, the paper presents novel perspective for the well-established literature on the presidential puzzle pioneered by @santa2003presidential, while it presents a long term perspective to the evolution of herding dynamics in the U.S. stock market. 

Employing the return-based herding tests of @christie1995following and @chang2000examination, we first show that herding is more pronounced during periods of high market volatility or crisis periods across all industry groups examined. While herding is primarily driven by fundamental information regarding the stock market, we also find evidence of intentional herding, particularly during crisis periods, due to non-fundamental market factors. More importantly, we establish a link between herd behavior and political cycles. We show that herding is more prevalent during democratic administrations, in line with the risk-based model of @pastor2020political that associates Democratic presidencies with high risk aversion and thus high risk premia in equities. Furthermore, we present evidence of spurious herding during periods when presidential economic approval is high, while intentional anti-herding is also present mostly for production-based industries during such periods, implying heterogeneous effects of partisan politics on industry herding. The remainder of the paper is structured as follows. Section 2 presents a brief review of the literature on herding and the role of political cycles in the stock market. Section 3 describes the data and methodology. Section 3 presents the results and Section 4 concludes. 


# Literature Review

Literature on the behavioral effects on decision making has flourished in recent decades [for a detailed review see @aggarwal2014animal]. The motivation behind these studies are built on behavioural economics that lie in the intersection of psychology and economics attempting to shed light on how decisions made by agents who act under cognitive and emotional constraints [@mullainathan2000behavioral] affect the efficient processing of information in financial markets. This follows the argument that human behavior that is by nature prone to heuristics, emotional biases and framing effects [@aggarwal2014animal] might result in sub-optimal decisions that in turn cause market inefficiencies and market failures. Under this context, market participants and financial economists provide increasingly convincing evidence that imitative behaviour is widespread in financial markets [@devenow1996rational]. This correlated trading behaviour of investors at large scale could pose significant threats to financial stability since they might increase volatility and create headaches for policy-makers and supervisory authorities [@demirer2015commodity].

Accordingly, the concept of herding behavior started to gain the attention of researchers and academics early in the 1990s, pioneered by the works of @banerjee1992simple and @bikhchandani1992theory. Literature on herding is voluminous but still remains inconclusive on the motives and conditions that bring about such behavior. Herding behaviour is generally categorized into unintentional and intentional herding. In the former case, investors respond to a common set of information associated with market developments and in the latter case investors, intentionally discard their own beliefs and decide to follow the decisions of so-called informed traders [@bikchandani2000herd]. @spyrou2013herding and @komalasari2022herding provide some excellent reviews of the relevant studies. In the literature, herding studies have been well applied to different contexts including equity markets [see *interalia* @demirer2006does; @chiang2010empirical; @ukpong2021determinants], bond markets [see *interalia* @galariotis2016herd], commodities [@demirer2015commodity; @babalos2015herding; @babalos2015commodity; @junior2020analyzing; @youssef2022oil, real estate markets [see *interalia* @philippas2013herding; @lesame2024herding] across a wide range of international settings. Separately, another strand of literature focus on herding behaviour of institutional investors including money managers [@jiang2018does], financial analysts [@leece2017effects] and FX market forecasters [@tsuchiya2015herding], generally using transaction or holding level data. Most recently, herding tests have been extended to the cryptocurrency markets which has received increasing attention in the literature [see *interalia* @bouri2019herding].

Examining the implications of herding in market valuations and price dynamics, some studies show that correlated actions of investors at a large scale could induce market instability and volatility, while one can also argue that herding would be more prevalent during periods of market turmoil or increased volatility. Considering that correlated behavior of investors would be more prevalent within asset classes of similar characteristics, one strand of the literature has focused on herding activity across sectors or in an international setting, however, presenting contradictory results [see *interalia* @christie1995following; @choi2009institutional; @litimi2016herding]. One reason for why herding behaviour might be more prevalent within an industry setting can be due to the specific style of the industry, the economic conditions that might affect each sector or the trading patterns of investors in certain industries. For example, @henker2006investors find that herding is more prevalent in industries such as materials, consumer staples and financials. Similarly, employing data from 32 countries, @gkebka2013international find that herding is more intense in sectors such as basic materials, consumer services, and oil and gas and this behaviour might be the result of a group of investors that follow each other in and out of markets, overconfidence, or excessive flight to quality. They also stressed that testing herding towards market could underestimate the real effect of herding behaviour and research should try to shed light on the behaviour of investors at the sector level. To support this argument, in an application to the Malaysian stock market, @dehghani2014sectoral find that herding behaviour is only constrained to technology sector. Similarly, studying nine Asian markets, by @zheng2017herding show evidence of herding at the sectoral level, particularly in the Technology and Financial industries, but weaker in the Utility industry. Moreover, herding in certain industries is found to be more intense during bear markets and periods of low trading volume. In the US context, @bensaida2017herding confirm the presence of herding behaviour in 10 out of 12 US sectors during periods of financial crises and bubbles. Similarly, @ukpong2021determinants document weak evidence of herding especially in the Financials, Real Estate, Telecoms and Utilities sectors for US market.

In another well-established strand of the literature, evidence suggests the presence of a political cycle effect in stock market returns in the US. Documenting that the US stock market has generally produced superior returns under Democratic presidents than under Republicans, @santa2003presidential argue that this phenomenon cannot be explained by risk-based arguments, thus calling it the “presidential puzzle”.^[Similarly, @demirer2018presidential show that the political cycle effect extends beyond returns to asset market correlations.] However, in a later, study, @pastor2020political develop a model of political cycles in which the presidential puzzle emerges endogenously and link the presidential premium to risk aversion such that when risk aversion is high, voters are more likely to elect a Democratic president because they demand more social insurance whereas when risk aversion is low, a Republican president is likely to be elected since the voters want to take on more business risk. The risk-based arguments are further supported by other studies that establish a link between political uncertainty and corporate investment [@jens2017political], volatility in financial markets [@boutchkova2012precarious] and a risk premium in asset returns during politically uncertain times [@montone2022does]. In a study that is more related to our focus of herding, the recent work by @gavriilidis2024political provides evidence of herding by institutional investors during politically uncertain times although thus study does not directly relate herding to the presidential cycle that is well-established in the literature. In our case, we attempt to examine herding using a long history of data dating back to 1926 by relating it to the presidential cycle along with the non-partisan political dynamics that have been shown to affect stock market returns [e.g. @montone2022does].

## Data and Methodology

## Data

Our analysis utilises Kenneth French's 49 industry portfolio returns along with the Fama-French factor series that we use in the subsequent fundamental vs non-fundamental herding tests covering a long history of stock market data from July 1926 to July 2022.^[\url{http://mba.tuck.dartmouth.edu/pages/faculty/ken.french}] The industry portfolios range from 5 to 49 industry groups and are formed by assigning stocks from the NYSE, AMEX, NASDAQ to an industry portfolio using the four-digit Centre for Research in Security Prices Standard Industry Classification Codes (CSRP-SIC). In our herding tests, we create five industry groups from the 49 industries to calculate the cross sectional dispersions as outlined in the methodology section. @tbl-grouping provides the group the industries based on the CSRP-SICs and @tbl-desc in the Appendix presents the descriptive statistics for the industry data. Given that we also focus on herding behaviour in periods of financial crisis, we examine herding during 5 major crises periods, namely the Great Depression, Dot-com Bubble, Great Financial Crisis and the recent Covid-Crisis as shown in @tbl-crises_description.^[\url{https://en.wikipedia.org/wiki/List_of_economic_crises}] 

To examine the effect of political cycles on industry herding, we examine the dynamics of industry herding across the US presidential terms shown in @tbl-terms as outlined in @eq-political.^[The US presidential terms are obtained from \url{https://en.wikipedia.org/wiki/List_of_United_States_presidential_election_dates}] Furthermore, motivated by the established evidence that non-partisan politics have a significant effect on stock market returns and investors tend to be more optimistic when their preferred political party is in power [@montone2022does], while party affiliation affects stock market participation [@kaustia2011stock] and risk taking behavior [@bonaparte2017political], we utilize the presidential economic approval ratings (PEAR) data collected by several organisations^[These include ABC News, American Research Group, CNN, and Fox News, amongst others.] based on the question, ``Do you approve or disprove of the way (name of the president) is handling the economy?''.^[The PEAR data can be accessed at  \url{https://www3.nd.edu/~zda/PEAR.xlsx}]  In a recent study, @chen2023presidential document a risk premium associated with PEAR such that stocks that have high exposure to changes in PEAR significantly under perform those with low betas, thus associating a firm's alignment to the incumbent president's economic policies with mispricing of its stock. In our case, we examine market's inefficient procession of information from a different context by relating it to herding behavior. 

## Benchmark test for industry herding

Following @christie1995following and @chang2000examination, we calculate the cross-sectional absolute standard deviations
($CSAD_{t}$) for each industry group. The $CSAD_{t}$ is calculated for all industries as follows:

$$
CSAD_{t} = \frac{1}{N}\sum_{i =1}^{N}{|R_{i,t} - R_{m,t}|},
$$ {#eq-csad}

where $R_{i,t}$ observed returns from individual industry $i$ at time $t$ and $R_{m,t}$ is the market return. In this case, $R_{m,t}$ is the group industry return which is captured by the cross-sectional average of the individual industry returns. The return dispersion measures capture the directional similarity in industry returns at a given point in time with respect to the aggregate market or group return. Herding tests, in turn, are based on the pattern of return dispersions during periods of large price movements.

The rationale behind the testing methodology is that, if herding is present, the correlated trades by investors will lead to greater directional similarity in industry returns, thus leading to lower dispersion in returns. This can be measured by the sign of the coefficients of the relationship between the return dispersion and $R_{m, t}$ and $R_{m, t}^2$ (or market return measures) in these equations for the general market herding:

$$
CSAD_{t} = \gamma_0 +  \gamma_1|R_{m, t}| +  \gamma_2R_{m, t}^2 + \epsilon_{t},
$$ {#eq-csad2}

where $\gamma_2$ is the herding coefficient. The expectation is that $\gamma_1 > 0$ and $\gamma_2 < 0$ if herding is present. $R_{m, t}^2$, therefore, is a non-linear term which captures the herding effect. This non-linear effect implies no herding when $\gamma_2 = 0$, anti-herding when $\gamma_2 > 0$ and, obviously, herding when $\gamma_2 < 0$. We estimate $CSAD_{t}$ with heteroskedastic and autocorrelation consistent (HAC) standard errors [see @newey1987simple.^[We utilise the Newey-West estimator for all estimations in this paper.] Furthermore, for all testing equations, we estimate changes in herding behaviour over time using a rolling-window approach with a 250 day.^[This is a commonly used window in the literature. We do this throughout the herding analysis]

The literature shows that herding is more pronounced in times of market crisis or high volatility [@balcilar2014drives]. To examine whether this is the case based on a long history of data, we use a dummy variable approach to test whether herding is more pronounced during periods of financial crisis. The benchmark model in @eq-csad2 is therefore adjusted to include the $D^{crisis}$, which is a crisis period indicator, as follows:

$$
\begin{aligned}
CSAD_{t} = \gamma_0 +  \gamma_1D^{crisis}|R_{m, t}| + \gamma_2(1 - D^{crisis})|R_{m,t}| + \\  \gamma_3D^{crisis}R_{m, t}^2 + \gamma_4(1-D^{crisis})R_{m,t}^2 + \epsilon_{t},
\end{aligned}
$$ {#eq-csad3}

where $D_{crisis}$ is a dummy variable which takes the value of 1 during periods of financial crisis and 0 otherwise. That is, to isolate
the herding effect ($\gamma_3D^{crisis}R_{m, t}^2$) only to periods of market crisis. Therefore, in @eq-csad3 herding is present if $\gamma_3 < 0$ and is significant.

## Industry herding and fundamental information

Herding can be considered either a rational response to public information by investors, or an accumulation of irrational behaviour by investors due to, for example, fear of under performance or fear of missing out on a market run [see @Bikhchandani2001]. In order to test for the rationality of herding, we test whether herding is related to fundamental information and use the following equations to test for the presence of fundamental versus non-fundamental herding. To that end, we first isolate the non-fundamental component of herding as follows:

$$
CSAD_t = \alpha + \beta_1(R_{m,t} - Rf_t) + \beta_2HML_t + \beta_3SMB_t + \xi_t,
$${#eq-info}


where $Rf_t$ is the risk-free rate, $HML_t$ is the high-minus-low portfolio and $SMB_t$ is the small-minus-big portfolio. The $Rf_t$, $HML_t$ and $SMB_t$ are all from the Fama-French 3 factor model [see @fama1993common]. The non-fundamental component of herding is then obtained as:

$$
CSAD_{NONFUND, t} = \xi_t.
$${#eq-nonfunda}

It stands to reason that the fundamental component of herding is then:
$$
CSAD_{FUND, t} = CSAD_t - CSAD_{NONFUND, t},
$${#eq-funda}

where $CSAD_{FUND, t}$ is the fundamental component of herding.

Having decomposed the herding model into components associated with fundamental and non-fundamental informations, we then test the relationship between $CSAD_{NONFUND, t}$ and $CSAD_{FUND, t}$ and herding as follows:

$$
CSAD_{NONFUND,t} = \gamma_0 +  \gamma_1|R_{m, t}| +  \gamma_2R_{m, t}^2 + \epsilon_{t}
$${#eq-nonfundaherd}


$$
CSAD_{FUND,t} = \gamma_0 +  \gamma_1|R_{m, t}| +  \gamma_2R_{m, t}^2 + \epsilon_{t}
$${#eq-fundaherd}


where $\gamma_2$ is the herding coefficient. Again, the expectation is that $\gamma_1 > 0$ and $\gamma_2 < 0$ if herding is present.

Extending the analysis further, we test if the rational and irrational components of herding are more pronounced during periods of financial crisis. We use the following equations to test for the relationship between herding and fundamental information, and herding and non-fundamental information during periods of financial crisis:

$$
\begin{aligned}
CSAD_{NONFUND, t} = \gamma_0 +  \gamma_1D^{crisis}|R_{m, t}| + \gamma_2(1 - D^{crisis})|R_{m,t}|  + \\  
\gamma_3D^{crisis}R_{m, t}^2 + \gamma_4(1-D^{crisis})R_{m,t}^2 + \epsilon_{t},
\end{aligned}
$$ {#eq-nonfundacrisis}

$$
\begin{aligned}
CSAD_{FUND, t} = \gamma_0 +  \gamma_1D^{crisis}|R_{m, t}| + \gamma_2(1 - D^{crisis})|R_{m,t}|  + \\ \gamma_3D^{crisis}R_{m, t}^2 + \gamma_4(1-D^{crisis})R_{m,t}^2 + \epsilon_{t},
\end{aligned}
$$ {#eq-fundacrisis}

where, again, to isolate the herding effect ($\gamma_3D^{crisis}R_{m, t}^2$) to periods of market crisis. $D_{crisis}$ is a dummy variable which takes the value of 1 during periods of financial crisis and 0 otherwise. Therefore, both in @eq-nonfundacrisis and @eq-fundacrisis herding is present if $\gamma_3 < 0$ and is significant.

## Industry herding and political cycles

Motivated by the recent findings that risk aversion is a determinant of herding [@nath2020investor] and the risk-based arguments associated with a presidential cycle in stock market returns [@pastor2020political], we construct a somewhat novel test to explore whether herding is related to political cycles. Controlling for market volatility in our model, we estimate the following equations:

$$
Pr(D^{herd} = 1 |\lambda_0 +  \lambda_1D^{party}  + \lambda_2\Gamma_t) = \lambda_0 +  \lambda_1D^{party}  + \lambda_2\Gamma_t,
$$ {#eq-political}

where $D^{herd}$ is dummy variable with value 1 when herding is present and 0 otherwise. $D^{party}$ is a dummy variable which takes the value of 1 for the Democratic party, and 0 for the Republican party.^[@eq-political to @eq-politicalfund are estimated as linear probability and probit models. The estimates of the linear probability model are the similar to the probit marginal effects. For simplicity, we use the linear probability model estimates and the probit marginal effects are shown in @tbl-probit in the Appendix.] In this framework, $\lambda_0$ is the Republican party estimate and $\Gamma_t$ is the market volatility obtained from a $GARCH(1,1)$ model of the overall market returns (CSRP) of the industry portfolios as described above.

A natural question which follows is if the political cycle is a determinant herding, how this relates to rational or irrational herding. Therefore, a similar analysis is conducted using herding related to fundamental and non-fundamental information by estimating:

$$
Pr(D^{herd}_{NONFUND} = 1 |\lambda_0 +  \lambda_1D^{party}  + \lambda_2\Gamma_t) = \lambda_0 +  \lambda_1D^{party}  + \lambda_2\Gamma_t,
$$ {#eq-politicalnonfund}

$$
Pr(D^{herd}_{FUND}= 1 |\lambda_0 +  \lambda_1D^{party}  + \lambda_2\Gamma_t) = \lambda_0 +  \lambda_1D^{party}  + \lambda_2\Gamma_t,
$$ {#eq-politicalfund}


where $D^{herd}_{NONFUND}$ and $D^{herd}_{FUND}$ are dummy variables with value 1 when non-fundamental and fundamental herding is present and 0 otherwise.

In the last step of our analysis, considering the evidence that investors tend to be more optimistic when their preferred political party is in power [@montone2022does], while party affiliation affects stock market participation [@kaustia2011stock] and risk taking behavior [@bonaparte2017political], we turn our attention to the effect of the performance of specific US presidents on industry herding. This is done by extending @eq-nonfundaherd and @eq-fundaherd to examine the effect of presidential approval ratings on herding behavior as:

$$
CSAD = \gamma_0 + \gamma_1|R_{m,t}| + \gamma_2R_{m, t}^2 + \gamma_3D_{high}R_{m,t}^2 + \gamma_4D_{low}R_{m,t}^2 + \epsilon_{t}, 
$$ {#eq-approval_overall}


$$
CSAD_{NONFUND} = \gamma_0 + \gamma_1|R_{m,t}| + \gamma_2R_{m, t}^2 + \gamma_3D_{high}R_{m,t}^2 + \gamma_4D_{low}R_{m,t}^2 + \epsilon_{t}, and
$$ {#eq-approval}


$$
CSAD_{FUND} = \gamma_0 + \gamma_1|R_{m,t}| + \gamma_2R_{m, t}^2 + \gamma_3D_{high}R_{m,t}^2 + \gamma_4D_{low}R_{m,t}^2 + \epsilon_{t}, 
$$ {#eq-approval_econ}

where $D_{high}$ is a dummy variable which takes a value of 1 when the presidential economic approval rating ($PEAR_t$) is high (i.e. in the top tercile of the sample distribution) and 0 otherwise, and $D_{low}$ is a dummy variable which takes a value of 1 when the presidential approval rating is low and 0 otherwise. Note that this model modification is in line with the evidence in @pastor2020political that herding is high when uncertainty in high (which coincides with low presidential ratings) and allows us to explore the effect of non-partisan politics on investor behavior from a novel angle.

# Empirical findings

## Results of the benchmark industry herding tests

@tbl-desc in the Appendix presents the descriptive statistics for the employed variables for the whole US market and for individual industries during normal times and during the pre-defined crisis periods based on the industry grouping scheme given in @tbl-grouping and the crises periods listed in @tbl-crises_description. Considering that our subsequent analysis focuses on the time variation on the herding coefficients obtained from rolling regressions, we construct the return-based statistics using daily returns, which yields over 25,000 observations in the sample. While Manufacturing experiences the highest volatility in returns, we observe low to zero returns in some industries during the earlier crisis periods influenced by high market volatility. Consistently, the cross-sectional return dispersions take on larger values during crisis periods, indicating greater variability in returns across the stocks in the industry during such periods.

@tbl-ols reports the ordinary least squares results for @eq-csad2 employing the US industry returns both at aggregate level and at an industry level. @tbl-ols is organized into three separate panels for the whole sample along with the results for UP and DOWN markets, captured by the top and bottom 5 percent of market returns. Examining the statistical significance and the sign of the herding coefficient $\gamma_2$ in the table, we do not observe evidence of industry herding for the whole sample in the top panel, in line with the evidence of limited evidence of herding at the sector level reported by @ukpong2021determinants. However, we observe more widespread evidence of herding when we focus on periods of large market fluctuations. Specifically, we find significant evidence consistent with herding in all industries as well as Consumables during UP markets, indicated by  a herding coefficient $\gamma_2$ of -0.00016 that is highly significant, while weak evidence of herding is observed for Manufacturing sector during DOWN markets.

The results for the static linear model reported in @tbl-ols, however, fails to capture the dynamic nature of herding over time. Therefore, following previous studies that highlight the dynamic nature of herding effect [@babalos2015commodity; @klein2013time; @mohamad2022birds] we estimate @eq-csad2 using a rolling window estimation period of 250 days. @fig-rol_gen presents the graphical illustration of the time-varying herding coefficients along with the time evolution of the t-statistics. Focusing on the estimated herding coefficients, $\gamma_2$, the rolling window analysis reveals substantial anti-herding effects, implies by the positive estimates for  $\gamma_2$, for the whole market (all industries) and for a number of industries, with periods of herding present only during the crisis periods. These results are in line with the findings of previous studies that document the dynamic nature of herding effects and that herding is closely related to crisis periods which leads to our subsequent analysis. 

@tbl-ols_crisis reports the ordinary least squares results for the benchmark model in @eq-csad2 employing the US industry returns both at aggregate level and at an industry level during the pre-defined four crises periods: the Great Depression, Dot-com Bubble, Great Financial Crisis and the Covid-19 crisis. The estimation of the crisis periods is performed according to @eq-csad3. As stated earlier, herding during crisis periods is verified by means of the negative sign of the estimated coefficient $\gamma_3$. The results reported in @tbl-ols_crisis point to the presence of significant herding effects for all industries examined during the four crisis periods. In particular, we find that all industries experience herding during the Dot-com Bubble and the Global Financial Crisis, while three out of five industries display strong herding effects during the Great Depression and Covid periods. These findings therefore confirm the close association between herding and heightened uncertainty during crisis periods. 

## Fundamental vs. non-fundamental herding

Earlier studies on herding including @christie1995following  and @Bikhchandani2001 argue that herding can develop intentionally as investors to suppress their private information and follow the market consensus. However, as @ali2023anti note, spurious herding can occur as a result of investors’ common, rational responses to public information, implying an informationally efficient market where investors collectively react to public information. Accordingly, following the relevant literature that attempts to isolate intentional from spurious herding for institutional investors [@holmes2013herding] and for stock market investors [@galariotis2015herding] we estimate @eq-nonfundaherd and @eq-fundaherd using the constructed CSAD series based on non-fundamental related and fundamental information. @tbl-ols_fund presents the results of the estimated coefficients that capture the existence of intentional and spurious herding through the coefficient $\gamma_2$ that is presented in the last column of @tbl-ols_fund. We observe that herding develops mainly as a response fundamental market information, indicated by the significant and negative herding coefficients reported in the top column. This finding supports the earlier results by @choi2015institutional  for international stock markets that herding is more likely to be driven by fundamental information. Herding on fundamentals is evident for the whole market and for three out of five industries namely Consumables, Manufacturing and Others. However, if we turn our attention to intentional herding, we observe some evidence of intentional anti-herding particularly in Health related industries. The evidence of fundamental herding is further confirmed graphically in @fig-rol_fundamental with the estimated herding coefficient falling into the negative territory largely during market crisis periods, in line with the evidence reported in the previous section. At the same time, the estimated herding coefficients plotted in @fig-rol_nonfundamental show stronger evidence of intentional anti-herding, particularly during the post-2000 period across all industries, suggesting that non-fundamental factors might drive investors towards anti-herding tendencies as well.

Focusing on the crisis periods, the results reported in @tbl-ols_crisis_fund show that periods of market crisis are often plagued with both types of herding with investors displaying herd behavior on both fundamental and non-fundamental information, particularly during the Great Depression, the Global Financial Crisis and Covid-19 periods. The only exception is the Dot-com bubble period during which investors engage in intentional herding since the coefficient of interest $\gamma_3$ appears negative and strongly statistically significant across all industries and the market as a whole. These results are partly consistent with those reported by @galariotis2015herding who document only non-fundamental herding during the sub-prime crisis for the whole market. Overall, our analysis points to some degree of heterogeneity in how investors respond to crisis periods in that crisis periods can induce spurious or intentional herding (or both) depending on the type of market crisis.

## Industry herding and political cycles

Having explored spurious and intentional herding formation during normal and crisis periods, we next report in @tbl-political the estimates for @eq-political to @eq-politicalfund to examine the role of political cycles on herding behaviour across the US industries. As discussed earlier, this is motivated by the well-established evidence of a presidential cycle in stock market performance in which the stock market dynamics respond to partisan politics. Focusing on the coefficient of interest $\lambda_1$, we observe a positive and statistically significant value when we measure overall herding for the market as a whole along with three other industries namely Consumables, Health and Other. This finding reflects greater tendency by investors to engage in herd behavior when Democrats are in power, in line with the risk-based explanation by @pastor2020political that associates Democratic presidencies with greater risk aversion. The findings from linear probability models are further affirmed by the probit results in @tbl-probit reported in the Appendix. In essence, our findings establish a direct link between risk aversion and herd behavior such that greater aversion to risk induces herd formation in the stock market, in line with the earlier evidence by @nath2020investor that risk-aversion is a driving factor behind herding behaviour. 

Distinguishing between herding based on fundamental and non-fundamental information, we find in @tbl-political that Democratic administrations are more likely to induce spurious herding, implied by the positive and significant  $\lambda_1$ estimates for the fundamental herding model in three out of five industries. @pastor2020political argue that when risk aversion is high, as one would expect to be so during economic crises, voters are more likely to elect a Democratic president because they demand more social insurance. However, when risk aversion is low, voters are more likely to elect a Republican because they are willing to take on more business risk. Accordingly, one can argue that greater risk aversion drives investors to suppress their private information and follow the market consensus based on publicly available market information. 


Finally, extending the analysis to the role of non-partisan politics on herd formation in the stock market, we observe in @tbl-pear_alt that spurious herding is dominant during periods when presidential economic approval is high, particularly for Business Services and Health. At the same time, intentional anti-herding is also observed mostly for production-based industries during such periods, implying heterogeneous effects of partisan politics on industry herding. The heterogeneous findings across industries support the prior evidence that different industries have differential exposures to presidential policies such that industries with greater exposure to government spending earn higher returns during Democratic presidencies [@belo2013government] and industries with greater political sensitivity earn higher returns [@addoum2016political]. Accordingly, one can argue that the significant anti-herding effect of presidential economic approval ratings largely on production-based industries might reflect investor confidence in economic policies that induce some investors to go against the market consensus in those industries. Overall, these findings establish a close association between partisan politics and investor in financial markets.

# Conclusion

The main goal of this study is to explore the role of political effects on investor behavior in the stock market, with a particular focus on herding behavior. Utilizing static and rolling-window models for U.S industries over a long history of data dating back to 1926, we present significant evidence of industry herding during crisis periods. Distinguishing between spurious and intentional herding, our results also show that industry herding is primarily driven by fundamental information regarding the stock market, while intentional herding is also present , particularly during crisis periods, due to non-fundamental market factors. More importantly, we establish a link between herd behavior and political factors. We show that herding is more prevalent during Democratic administrations, in line with the risk-based model of @pastor2020political that associates Democratic presidencies with high risk aversion and thus high risk premia in equities. Furthermore, we present evidence of spurious herding during periods of high approval of presidential economic policies, while intentional anti-herding is also present mostly for production-based industries during such periods, implying heterogeneous effects of partisan politics on industry herding in line with the prior evidence by @belo2013government and @addoum2016political that different industries have differential exposures to presidential policies and government spending. We also observe evidence consistent with anti-herding during periods of high presidential economic approval ratings, particularly in the case of production-based industries, which might reflect investor confidence in economic policies that induce some investors to go against the market consensus in those industries. While our findings support the earlier evidence that risk-aversion is a driving factor of herding behaviour [e.g. @nath2020investor], they also establish a link between partisan politics and investor behavior in financial markets.

Our findings have important implications for policy-makers, and regulators who are interested in understanding the role of political factors over the dynamics of investor behavior in financial markets. Considering the established evidence that herding can drive up volatility in financial markets and distort asset prices, regulators and policy-makers can work on improving the quality of policy signals regarding possible changes or implementation of their economic policies. At the same time, risk management requirements can be instituted to account for political factors in valuation and risk management models. This is especially important given the recent evidence by @chen2023presidential that presidential politics can be a source of mispricing in financial markets. Accordingly, our results suggest that herding behavior could be a driving factor behind such mispricing in asset valuations. For future work, it could be interesting to extend our work to international stock markets as well different asset classes including bonds and commodities. Nevertheless, our work could be a starting point to explore the role of partisan politics on investor behavior and how this relationship can result in informational inefficiencies in financial markets.


\newpage
# References {.unnumbered}
::: {#refs}
:::



\newpage
```{r}
#| label: tbl-ols
#| tbl-cap: "Industry herding: Benchmark model"
#| cache: false

equation <-  as_equation(c("CSAD_{t} = \\gamma + \\gamma_1|R_{m, t}| +  \\gamma_2R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
  "\\gamma",
  "\\gamma_1 ",
  "\\gamma_2"
)

general_herding <- read_rds(here("Outputs", "artifacts_general_herding.rds"))
general_herding$models$ols_combined_tbl %>% 
 ungroup() %>% 
 as_grouped_data(groups = c("Extreme")) %>%
 as_flextable(hide_grouplabel = TRUE) %>%
  mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>% 
  mk_par(i =, j = c(2, 3, 4), part = "header", value = as_paragraph(as_equation(estimates))) %>% 
    add_footer_row(values = as_paragraph("Note: *** = p value < 0.01, ** = 0.01 < p value < 0.05, * = 0.05 < p value < 0.1.", " ", " The regressions are based on ", equation), colwidths = 4) %>% 
  hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>% 
  align(j = 1, align = "left", part = "all") %>% 
  merge_at(i = 1) %>% 
  align(i = 1, align = "center") %>% 
  merge_at(i = 8) %>% 
  align(i = 8, align = "center") %>% 
  merge_at(i = 15) %>% 
  align(i = 15, align = "center") %>% 
  autofit(add_w = 0.7)

```

\newpage
```{r}
#| label: tbl-ols_crisis
#| tbl-cap: "Industry herding during crisis periods"
#| cache: false
#| include: true
#| eval: true

equation <-  as_equation(c("CSAD_{t} = \\gamma + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
  "\\gamma",
  "\\gamma_1 ",
  "\\gamma_2",
  "\\gamma_3 ",
  "\\gamma_4"
)

CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl


CSAD_model_rol_crisis_tbl %>%
    ungroup() %>% 
  as_grouped_data(groups = c("Crisis")) %>% 
    as_flextable(hide_grouplabel = TRUE) %>%  
   mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>% 
   mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>% 
    add_footer_row(values = as_paragraph("Note: *** = p value < 0.01, ** = 0.01 < p value < 0.05, * = 0.05 < p value < 0.1."," ", " The regressions are based on ", equation), colwidths = 6) %>% 
  hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>% 
  align(j = 1, align = "left", part = "all") %>% 
  merge_at(i = 1) %>% 
  align(i = 1, align = "center") %>% 
  merge_at(i = 8) %>% 
  align(i = 8, align = "center") %>% 
  merge_at(i = 15) %>% 
  align(i = 15, align = "center") %>% 
  merge_at(i = 22) %>% 
  align(i = 22, align = "center") %>% 
  autofit(add_w = 0.1)


```

\newpage
```{r}
#| label: tbl-ols_fund
#| tbl-cap: "Industry herding on fundamental vs. non-fundamental information"
#| cache: false
#| include: true
#| eval: true

equation_1 <-  as_equation(c("CSAD_{NONFUND, t} = \\gamma + \\gamma_1R_{m, t}| + \\gamma_2R_{m, t}^2 + \\epsilon_{t}"))
equation_2 <-  as_equation(c("CSAD_{FUND, t} = \\gamma + \\gamma_1R_{m, t}| + \\gamma_2R_{m, t}^2 + \\epsilon_{t}"))
estimates <- c(
  "\\gamma",
  "\\gamma_1 ",
  "\\gamma_2"
)

CSAD_model_fundmamental <- read_rds(here("Outputs", "artifacts_fundamental_herding.rds"))
CSAD_model_fundamental_tbl <- CSAD_model_fundmamental$ols$ols_fund_tbl


CSAD_model_fundamental_tbl %>%
    ungroup() %>% 
  as_grouped_data(groups = c("Herd")) %>% 
    as_flextable(hide_grouplabel = TRUE) %>% 
   mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>% 
   mk_par(i =, j = c(2, 3, 4), part = "header", value = as_paragraph(as_equation(estimates))) %>% 
    add_footer_row(values = as_paragraph("Note: *** = p value < 0.01, ** = 0.01 < p value < 0.05, * = 0.05 < p value < 0.1.", " ", " The regressions are based on ", equation_1, " and ", equation_2), colwidths = 4) %>% 
  hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>% 
  align(j = 1, align = "left", part = "all") %>% 
  merge_at(i = 1) %>% 
  align(i = 1, align = "center") %>% 
  merge_at(i = 8) %>% 
  align(i = 8, align = "center") %>% 
  autofit(add_w = 0.6)


```

\newpage
```{r}
#| label: tbl-ols_crisis_fund
#| tbl-cap: "Fundamental vs. non-fundamental herding during crisis periods"
#| cache: false
#| include: true
#| eval: true

equation <-  as_equation(c("CSAD_{FUND, t} = \\gamma + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))

equation_2 <-  as_equation(c("CSAD_{NONFUND, t} = \\gamma + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
  "\\gamma",
  "\\gamma_1 ",
  "\\gamma_2",
  "\\gamma_3 ",
  "\\gamma_4"
)

CSAD_model_rol_crisis_fund <- read_rds(here("Outputs", "artifacts_crisis_fundamental.rds"))
CSAD_model_rol_crisis_fund_tbl <- CSAD_model_rol_crisis_fund$ols$ols_tbl


CSAD_model_rol_crisis_fund_tbl %>%
    ungroup() %>% 
  as_grouped_data(groups = c("Fund")) %>% 
    as_flextable(hide_grouplabel = TRUE) %>%  
   mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>% 
   mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>% 
    add_footer_row(values = as_paragraph("Note: *** = p value < 0.01, ** = 0.01 < p value < 0.05, * = 0.05 < p value < 0.1.", " ", " The regressions are based on ", equation, " and ", equation_2), colwidths = 6) %>% 
  hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>% 
  align(j = 1, align = "left", part = "all") %>% 
  merge_at(i = 1) %>% 
  align(i = 1, align = "center") %>% 
  merge_at(i = 8) %>% 
  align(i = 8, align = "center") %>% 
  merge_at(i = 15) %>% 
  align(i = 15, align = "center") %>% 
  merge_at(i = 22) %>% 
  align(i = 22, align = "center") %>% 
  merge_at(i = 29) %>% 
  align(i = 29, align = "center") %>% 
  merge_at(i = 36) %>% 
  align(i = 36, align = "center") %>% 
  merge_at(i = 43) %>% 
  align(i = 43, align = "center") %>% 
  merge_at(i = 50) %>% 
  align(i = 50, align = "center") %>% 
  autofit(add_w = 0.1)


```

\newpage
```{r}
#| label: tbl-political
#| tbl-cap: "Herding and political cycles."
#| cache: false

equation_1 <-
  as_equation(
    c(
      "Pr(D^{herd} = 1 | \\lambda_0 +  \\lambda_1D^{party}  + \\lambda_2\\Gamma_{t}) = \\lambda_0 +  \\lambda_1D^{party}  + \\lambda_2\\Gamma_{t}"
    ),
    height = 0.05,
    unit = "cm"
  )

equation_2 <-
  as_equation(
    c(
      "Pr(D^{herd}_{FUND} = 1 | \\lambda_0 + \\lambda_1D^{party} + \\lambda_2\\Gamma_{t}) = \\lambda_0 +  \\lambda_1D^{party} + \\lambda_2\\Gamma_{t}"
    ),
    height = 0.05,
    unit = "cm"
  )

equation_3 <-
  as_equation(
    c(
      "Pr(D^{herd}_{NONFUND} = 1 | \\lambda_0 +  \\lambda_1D^{party} + \\lambda_2\\Gamma_{t}) = \\lambda_0 +  \\lambda_1D^{party} + \\lambda_2\\Gamma_{t}"
    ),
    height = 0.05,
    unit = "cm"
  )

estimates <- c("\\lambda_0", "\\lambda_1", "\\lambda_2")

political <- read_rds(here("Outputs", "artifacts_party_dummy.rds"))
political$ols_party_dummy_model_tbl %>% 
  relocate(3, .before  = 2) %>% 
  ungroup() %>% 
  as_grouped_data(groups = c("Group")) %>% 
    as_flextable(hide_grouplabel = TRUE) %>% 
  mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>% 
  mk_par(i =, j = c(2, 3, 4), part = "header", value = as_paragraph(as_equation(estimates))) %>%
  add_footer_lines(values = as_paragraph("Note: *** = p value < 0.01, ** = 0.01 < p value < 0.05, * = 0.05 < p value < 0.1.", 
                                       " The regressions are based on ", equation_1,
                                       " , ",
                                       equation_2,
                                       " and ",
                                       equation_3)) %>%
  hline_bottom(part = "footer",  
               border = fp_border(
                 color = "black",
                 style = "solid",
                 width = 1
               )) %>% 
  align(j = 1, align = "left", part = "all") %>% 
  merge_at(i = 1) %>% 
  align(i = 1, align = "center") %>% 
  merge_at(i = 8) %>% 
  align(i = 8, align = "center") %>% 
  merge_at(i = 15) %>% 
  align(i = 15, align = "center") %>%
  autofit(add_w = 0.6)
  
```

\newpage
```{r}
#| label: tbl-pear_alt
#| tbl-cap: "Herding and presidential economic approval ratings."
#| cache: false

equation_0 <-
  as_equation(
    c(
      "CSAD = \\gamma_0 + \\gamma_1R_{m, t}| + \\gamma_2R_{m, t}^2 + \\gamma_3D_{high}R_{m, t}^2 + \\gamma_4D_{low}R_{m, t}^2 + \\epsilon_{t}"
    )
  )

equation_1 <-
  as_equation(
    c(
      "CSAD_{FUND} = \\gamma_0 + \\gamma_1R_{m, t}| + \\gamma_2R_{m, t}^2 + \\gamma_3D_{high}R_{m, t}^2 + \\gamma_4D_{low}R_{m, t}^2 + \\epsilon_{t}"
    )
  )

equation_2 <-
  as_equation(
    c(
      "CSAD_{NONFUND} = \\gamma_0 + \\gamma_1R_{m, t}| + \\gamma_2R_{m, t}^2 + \\gamma_3D_{high}R_{m, t}^2 + \\gamma_4D_{low}R_{m, t}^2 + \\epsilon_{t}"
    )
  )


estimates <- c("\\gamma_0", "\\gamma_1", "\\gamma_2", "\\gamma_3", "\\gamma_4")

par <- read_rds(here("Outputs", "artifacts_alternative_ratings_models.rds"))

par$models$pear_ols_fund_tbl %>% 
  ungroup() %>% 
  as_grouped_data(groups = c("Herd")) %>% 
    as_flextable(hide_grouplabel = TRUE) %>% 
  mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>% 
  mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
  add_footer_lines(values = as_paragraph("Note: *** = p value < 0.01, ** = 0.01 < p value < 0.05, * = 0.05 < p value < 0.1.",
                                       " The regressions are based on ", equation_0, ", ",
                                       equation_1, ", ",
                                       "and ", equation_2,
                                       ". PEAR is the presidential economic approval rating as described in the data section above. ",
                                       " All equations were estimated using OLS with robust standard errors."
                                   )) %>%
  hline_bottom(part = "footer",  
               border = fp_border(
                 color = "black",
                 style = "solid",
                 width = 1
               )) %>% 
  align(j = 1, align = "left", part = "all") %>% 
  merge_at(i = 1) %>% 
  align(i = 1, align = "center") %>% 
  merge_at(i = 8) %>% 
  align(i = 8, align = "center") %>% 
  merge_at(i = 15) %>% 
  align(i = 15, align = "center") %>% 
  autofit(add_w = 0.1)
  
```


\newpage
```{r}
#| label: tbl-pear_approval
#| tbl-cap: "Herding and presidential economic approval ratings in different presidential terms."
#| cache: false

equation_0 <-
  as_equation(
    c(
      "CSAD = \\gamma_0 + \\gamma_1R_{m, t}| + \\gamma_2R_{m, t}^2 + \\gamma_3D_{Democrat}D_{high}R_{m, t}^2 + \\gamma_4D_{Democrat}D_{low}R_{m, t}^2  + \\gamma_5D_{Republican}D_{high}R_{m, t}^2 + \\gamma_6D_{Republican}D_{low}R_{m, t}^2 + \\epsilon_{t}"
    )
  )

equation_1 <-
  as_equation(
    c(
      "CSAD_{FUND} = \\gamma_0 + \\gamma_1R_{m, t}| + \\gamma_2R_{m, t}^2 + \\gamma_3D_{Democrat}D_{high}R_{m, t}^2 + \\gamma_4D_{Democrat}D_{low}R_{m, t}^2  + \\gamma_5D_{Republican}D_{high}R_{m, t}^2 + \\gamma_6D_{Republican}D_{low}R_{m, t}^2 + \\epsilon_{t}"
    )
  )

equation_2 <-
  as_equation(
    c(
      "CSAD_{NONFUND} = \\gamma_0 + \\gamma_1R_{m, t}| + \\gamma_2R_{m, t}^2 + \\gamma_3D_{Democrat}D_{high}R_{m, t}^2 + \\gamma_4D_{Democrat}D_{low}R_{m, t}^2  + \\gamma_5D_{Republican}D_{high}R_{m, t}^2 + \\gamma_6D_{Republican}D_{low}R_{m, t}^2 + \\epsilon_{t}"
    )
  )


estimates <- c("\\gamma_0",
               "\\gamma_1",
               "\\gamma_2",
               "\\gamma_3",
               "\\gamma_4",
               "\\gamma_5",
               "\\gamma_6"
               )


approval_term <- read_rds(here("Outputs", "artifacts_approval_term_analysis.rds"))

approval_term$models$combined_pear_tbl %>% 
  ungroup() %>% 
  as_grouped_data(groups = c("Herd")) %>% 
  as_flextable(hide_grouplabel = TRUE) %>% 
  mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>%
  mk_par(i =, j = c(2, 3, 4, 5, 6, 7, 8), part = "header", value = as_paragraph(as_equation(estimates))) %>% 
  add_footer_lines(values = as_paragraph("Note: *** = p value < 0.01, ** = 0.01 < p value < 0.05, * = 0.05 < p value < 0.1.",
                                       " The regressions are based on ", equation_0, ", ",
                                       equation_1, ", ",
                                       "and ", equation_2,
                                       ". PEAR is the presidential economic approval rating as described in the data section above. ",
                                       " All equations were estimated using OLS with robust standard errors."
                                   )) %>%
 align(j = 1, align = "left", part = "all") %>% 
  merge_at(i = 1) %>% 
  align(i = 1, align = "center") %>% 
  merge_at(i = 8) %>% 
  align(i = 8, align = "center") %>% 
  merge_at(i = 15) %>% 
  align(i = 15, align = "center") %>% 
  hline_bottom(part = "footer",  
               border = fp_border(
                 color = "black",
                 style = "solid",
                 width = 1
               )) %>% 
  autofit(add_w = -0.6)
  
  


```

\newpage
```{r}
#| label: tbl-par_approval
#| tbl-cap: "Herding and presidential approval ratings in different presidential terms."
#| cache: false

equation_0 <-
  as_equation(
    c(
      "CSAD = \\gamma_0 + \\gamma_1R_{m, t}| + \\gamma_2R_{m, t}^2 + \\gamma_3D_{Democrat}D_{high}R_{m, t}^2 + \\gamma_4D_{Democrat}D_{low}R_{m, t}^2  + \\gamma_5D_{Republican}D_{high}R_{m, t}^2 + \\gamma_6D_{Republican}D_{low}R_{m, t}^2 + \\epsilon_{t}"
    )
  )

equation_1 <-
  as_equation(
    c(
      "CSAD_{FUND} = \\gamma_0 + \\gamma_1R_{m, t}| + \\gamma_2R_{m, t}^2 + \\gamma_3D_{Democrat}D_{high}R_{m, t}^2 + \\gamma_4D_{Democrat}D_{low}R_{m, t}^2  + \\gamma_5D_{Republican}D_{high}R_{m, t}^2 + \\gamma_6D_{Republican}D_{low}R_{m, t}^2 + \\epsilon_{t}"
    )
  )

equation_2 <-
  as_equation(
    c(
      "CSAD_{NONFUND} = \\gamma_0 + \\gamma_1R_{m, t}| + \\gamma_2R_{m, t}^2 + \\gamma_3D_{Democrat}D_{high}R_{m, t}^2 + \\gamma_4D_{Democrat}D_{low}R_{m, t}^2  + \\gamma_5D_{Republican}D_{high}R_{m, t}^2 + \\gamma_6D_{Republican}D_{low}R_{m, t}^2 + \\epsilon_{t}"
    )
  )


estimates <- c("\\gamma_0",
               "\\gamma_1",
               "\\gamma_2",
               "\\gamma_3",
               "\\gamma_4",
               "\\gamma_5",
               "\\gamma_6"
               )
               


approval_term <- read_rds(here("Outputs", "artifacts_approval_term_analysis.rds"))

approval_term$models$combined_par_tbl %>% 
  ungroup() %>% 
  as_grouped_data(groups = c("Herd")) %>% 
  as_flextable(hide_grouplabel = TRUE) %>% 
  mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>%
  mk_par(i =, j = c(2, 3, 4, 5, 6, 7, 8), part = "header", value = as_paragraph(as_equation(estimates))) %>% 
  add_footer_lines(values = as_paragraph("Note: *** = p value < 0.01, ** = 0.01 < p value < 0.05, * = 0.05 < p value < 0.1.",
                                       " The regressions are based on ", equation_0, ", ",
                                       equation_1, ", ",
                                       "and ", equation_2,
                                       ". PAR is the presidential economic approval rating as described in the data section above. ",
                                       " All equations were estimated using OLS with robust standard errors."
                                   )) %>%
 align(j = 1, align = "left", part = "all") %>% 
  merge_at(i = 1) %>% 
  align(i = 1, align = "center") %>% 
  merge_at(i = 8) %>% 
  align(i = 8, align = "center") %>% 
  merge_at(i = 15) %>% 
  align(i = 15, align = "center") %>% 
  hline_bottom(part = "footer",  
               border = fp_border(
                 color = "black",
                 style = "solid",
                 width = 1
               )) %>% 
  autofit(add_w = -0.6)
  
  


```



\newpage
```{r}
#| label: fig-rol_gen
#| fig-cap: " Industry herding over time. Note: The perforated lines represents a 5% level of significance."
#| fig-height: 4
#| fig-width: 8
#| cache: true


rol_gg <- general_herding$graphs$rol_gg
rol_gg
```

\newpage

```{r}
#| label: fig-rol_fundamental
#| fig-cap: "Industry herding on fundamental information over time. Note: The perforated lines represents a 5% level of significance."
#| fig-height: 4
#| fig-width: 8
#| cache: true

rol_fundamental_gg <- CSAD_model_fundmamental$ols_rol_graphs$rol_fundamental_gg
rol_fundamental_gg

```

\newpage

```{r}
#| label: fig-rol_nonfundamental
#| fig-cap: "Industry herding on non-fundamental information over time. Note: The perforated lines represents a 5% level of significance."
#| fig-height: 4
#| fig-width: 8
#| cache: true

rol_nonfundamental_gg <- CSAD_model_fundmamental$ols_rol_graphs$rol_nonfundamental_gg
rol_nonfundamental_gg

```



\setcounter{section}{0}
\renewcommand{\thesection}{\Alph{section}}

\setcounter{table}{0}
\renewcommand{\thetable}{A\arabic{table}}

\setcounter{figure}{0}
\renewcommand{\thefigure}{A\arabic{figure}}



\newpage



# Appendix

```{r}
#| label: tbl-grouping
#| tbl-cap: "Industry grouping using CRSP SICs"
#| tbl-colwidths: auto
#| cache: false

returns_data <- read_rds(here("Outputs", "artifacts_returns_data.rds"))
aggregation_scheme_tbl <- returns_data$full_data$aggregation_scheme_tbl
aggregation_scheme_tbl %>% 
  flextable() %>% 
  align(align = "left", part = "all") %>% 
  autofit(add_w = -0.1)
```
\newpage

```{r}
#| label: tbl-desc
#| tbl-cap: "Descriptive statistics"
#| cache: false

descriptives <- read_rds(here("Outputs", "artifacts_descriptives.rds"))
descriptives_tbl <- 
  descriptives$descriptives_tbl %>% 
  ungroup()


descriptives_tbl %>%
  as_grouped_data(groups = c("Category")) %>%
  as_flextable(hide_grouplabel = TRUE) %>% 
  align(align = "center", part = "all") %>% 
  align(align = "left", j = 1, part = "all") %>% 
  align(align = "left", j = 2, part = "all") %>% 
  merge_at(i = 1) %>% 
  align(i = 1, align = "center") %>% 
  merge_at(i = 12) %>%
  align(i = 12, align = "center") %>%
  merge_at(i = 23) %>%
  align(i = 23, align = "center") %>%
  merge_at(i = 34) %>% 
  align(i = 34, align = "center") %>%
  merge_at(i = 45) %>%
  align(i = 45, align = "center") %>%
  merge_at(i = 56) %>%
  align(i = 56, align = "center") %>%
  autofit(add_w = 0.45)

```
\newpage 
 
```{r}
#| label: tbl-crises_description
#| tbl-cap: "Crises periods. Source: Wikipedia (2023)"
#| cache: false

crisis_tbl <- 
  tibble(
  "Crisis" = c("Great Depression", "Dot-com Bubble", "Financial Crisis", "Covid Crisis"),
  "Start" = c("1929-01-01", "1997-01-01", "2007-01-01", "2020-01-01"),
  "End" = c("1939-12-31", "2003-12-31", "2009-12-31", "2021-12-31")
) 

crisis_tbl %>% 
  flextable() %>% 
  align(j = 1, align = "left", part = "all") %>% 
  autofit(add_w = 1.5)

```
\newpage

```{r}
#| label: tbl-terms
#| tbl-cap: "Presidential terms"
#| cache: false

# importing presidential terms
presidential_terms <- read_rds(here("Outputs", "artifacts_presidential_terms.rds"))
presential_terms_tbl <- 
  presidential_terms$terms_tbl %>% 
  filter(Term_start >= "1920-01-01") %>%
  rename(
    "Start" = "Term_start",
    "End" = "Term_end") %>% 
  mutate(
    "Start" = lubridate::year(Start),
    "End" = lubridate::year(End)
  )

# creating table of presidential terms
presential_terms_tbl %>% 
  flextable() %>% 
  align(j = 1, align = "left", part = "all") %>% 
  colformat_double(j = 2:3, digits = 0, big.mark = "") %>%
  autofit(add_w = 1.8)

```
\newpage

```{r}
#| label: tbl-probit
#| tbl-cap: "Probit estimation (Marginal Effects)"
#| cache: false

equation_1 <-
  as_equation(
    c(
      "Pr(D^{herd} = 1 | \\lambda_0 +  \\lambda_1D^{party}  + \\lambda_2\\Gamma_{t}) = \\lambda_0 +  \\lambda_1D^{party}  + \\lambda_2\\Gamma_{t}"
    ),
    height = 0.05,
    unit = "cm"
  )

equation_2 <-
  as_equation(
    c(
      "Pr(D^{herd}_{FUND} = 1 | \\lambda_0 + \\lambda_1D^{party} + \\lambda_2\\Gamma_{t}) = \\lambda_0 +  \\lambda_1D^{party} + \\lambda_2\\Gamma_{t}"
    ),
    height = 0.05,
    unit = "cm"
  )

equation_3 <-
  as_equation(
    c(
      "Pr(D^{herd}_{NONFUND} = 1 | \\lambda_0 +  \\lambda_1D^{party} + \\lambda_2\\Gamma_{t}) = \\lambda_0 +  \\lambda_1D^{party} + \\lambda_2\\Gamma_{t}"
    ),
    height = 0.05,
    unit = "cm"
  )

estimates <- c("\\lambda_1", "\\lambda_2")

political$probit_party_dummy_model_tbl %>% 
  ungroup() %>% 
  as_grouped_data(groups = c("Group")) %>% 
    as_flextable(hide_grouplabel = TRUE) %>% 
  mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>% 
  mk_par(i =, j = c(2, 3), part = "header", value = as_paragraph(as_equation(estimates))) %>%
  add_footer_lines(values = as_paragraph("Note: *** = p value < 0.01, ** = 0.01 < p value < 0.05, * = 0.05 < p value < 0.1.", 
                                       " The marginal effects are based on probit estimations of ", equation_1,
                                       " , ",
                                       equation_2,
                                       " and ",
                                       equation_3)) %>%
  hline_bottom(part = "footer",  
               border = fp_border(
                 color = "black",
                 style = "solid",
                 width = 1
               )) %>% 
  align(j = 1, align = "left", part = "all") %>% 
  merge_at(i = 1) %>% 
  align(i = 1, align = "center") %>% 
  merge_at(i = 8) %>% 
  align(i = 8, align = "center") %>% 
  merge_at(i = 15) %>% 
  align(i = 15, align = "center") %>%
  autofit(add_w = 1)


```



